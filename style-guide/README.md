# PHP Coding Style Guide

Данное руководство к стилю кода основано но [PSR (PHP Standard Recommendation)](https://github.com/php-fig/fig-standards), здравом смысле и некоторых субъективных предпочтениях.

Если в компании или команде, в которой вы работаете или будете работать, свои правила, то придется придерживаться их.

Ну а если вы студент на курсе PHP в Epic Skills, то выполнение этих пунктов обязательно для успешной сдачи учебного проекта. Это не только ускорит проверку кода, но и покажет что вы умеете работать, следуя принятым правилам и требованиям.

Некоторые из пунктов, такие как отступы, пустая строка в конце файла и прочие, легко настраиваются в IDE или редакторе, поддерживающем [EditorConfig](http://editorconfig.org/). Так же легко табы заменяются на пробелы.

## Основное

- Используйте полный открывающий тег **`<?php`** в файлах, содержащих только код PHP.

- Используйте полный открывающий тег **`<?php`** в файлах, содержащих код HTML. Вместо **`<?php echo $var; ?>`** используйте краткую запись **`<?= $var; ?>`**:

```
<p><?= $content; ?></p>
```

- Если файл содержит только код PHP, закрывающего тега **`?>`** быть не должно.

- Файл с кодом PHP должен заканчиваться одной пустой строкой.

- В конце строк не должно быть пробельных символов.

- Файлы должны быть в формате UTF-8 without BOM и с переводом строк в стиле Unix.

- Длина строки не должна превышать 120 символов, а лучше делать её не более 80.

- Файл должен содержать либо инструкции (функции, классы, объявление констант), либо вывод текст на экран, но всё вместе.

- Придерживайтесь принципа разделения ответственности (Принцип единственной обязанности, Single responsibility principle), то есть каждый файл, класс, функция или метод должны выполнять одну логическую задачу.

- Используйте одну инструкцию на одной строке:

```php
<?php
// плохо
$foo = substr(strtoupper('test'), 0, 1);

// хорошо
$foo = 'test';
$foo = strtoupper($foo);
$foo = substr($foo, 0, 1);
```

```php
<?php
// плохо
$foo = 'test'; $foo = strtoupper($foo); $foo = substr($foo, 0, 1);

// хорошо
$foo = 'test';
$foo = strtoupper($foo);
$foo = substr($foo, 0, 1);
```

## Отступы, пробелы, переносы строк

- Для отступов используйте 4 пробела, не табы.

- Пустые строки (не более трех) в коде допустимы для удобства чтения и разделения логических блоков части кода.

- Бинарные операторы (`+`, `=`, `!=`, `-`, `==`, `>`, `.=` и т.п.) должны быть отделены от операндов пробелом с обоих сторон:

```php
<?php
// плохо
$a='Some text';
$d=$c+$d;

// хорошо
$a = 'Some text';
$d = $c + $d;
```

- Унарные операторы (`++`, `--`, `!`) не должны отделяться пробелом от операнда:

```php
// плохо
$i ++ ;

// хорошо
$i++;
```

- Открывающая и закрывающая фигурные скобки, отделяющие тело функции или метода, должны быть на новой строке.

```php
<?php
function myFunction()
{
    return 'I`m good function with bad unclear name!';
}
```

- Между названием функции или метода и открывающими скобками не должно быть пробела:

```php
<?php
// плохо
myFunction ();

// хорошо
myFunction();
```

- После открывающей и перед закрывающей круглой скобкой в функции или методе не должно быть пробелов. Между аргументами должен быть пробел только после запятой.

```php
<?php
// плохо
myFunction( $arg1 , $arg2 );

// хорошо
myFunction($arg1, $arg2);
```

## Именование, написание

- Все ключевые слова должны быть написаны в нижнем регистре (**`true`**, **`false`**, **`null`** и т.п.).

- Названия переменных, функций, классов, методов и т.д. должны быть понятны и соответствовать их назначению. Имя переменной, свойства или константы должно быть существительным (отвечать на вопрос "что"), а функции или метода - глаголом (отвечать на вопрос "что делает"):

```php
<?php
// плохо
$a = 'I don`t know that is here...';
func();

// хорошо
$myName = 'Anonymous';
sayMyName();
```

- Названия никогда не должны формироваться методом транслитерации! Если вы плохо знаете английский язык, во-первых, учите, благо возможностей сейчас много, а разработчик без знания английского далеко не продвинется. А во-вторых, используйте онлайн переводчик, выбирая подходящее значение того или иного слова.

- Названия переменных, функций и методов должны быть в lowerCamelCase.

- Названия констант должны быть в ВЕРХНЕМ_РЕГИСТЕ со знаком подчеркивания в качестве разделителя слов.

- Названия пространств имен, классов, интерфейсов и трейтов должны быть в UpperCamelCase.

## Строки

- Строки должны быть заключены в одинарные кавычки.

- Использование переменных вместе со стоками должно быть через конкатенацию. Перед и после оператора (точки) должны быть пробелы.

```php
<?php
$name = 'Vasilisa';
$greeting = 'Hello, ' . $name;
```

## Массивы

- Используйте **`[]`** вместо **`array()`**.

- После запятой при перечислении элементов должен быть пробел (если это только не элемент массива в многострочном представлении), так же пробел должен быть до и после **`=>`**.

```php
<?php
$colors = ['red', 'blue', 'pink'];

// тут пробелов после запятой быть не должно
$users = [
    1 => 'Vasya',
    2 => 'Petya',
    3 => 'Maria',
];
```

## Приведение типов

- Используйте **`(int) $foo`**, **`(bool) $foo`**, **`(float) $foo`**, **`(string) $foo`** вместо **`intval($foo)`**, **`boolval($foo)`**, **`floatval($foo)`** и **`strval($foo)`**.

- После имени требуемого типа, заключенного в круглые скобки, должен быть пробел.

```php
<?php
$name = (string) $userName;
```

## Управляющие конструкции

- После ключевого слова конструкции перед открывающей круглой скобкой должен быть пробел.

```php
<?php
// плохо
if($i == 1) {
    // do something...
}

// хорошо
if ($i == 1) {
    // do something...
}
```

- После открывающей круглой скобки и перед закрывающей круглой скобкой пробелов быть не должно.

```php
<?php
// плохо
if ( $i == 1 ) {
    // do something...
}

// хорошо
if ($i == 1) {
    // do something...
}
```


- Между закрывающей круглой скобкой и открывающей фигурной должен быть пробел. Открывающая фигурная скобка должна быть на той же строке.

```php
<?php
// плохо
if ($i == 1){
    // do something...
}
// плохо
if ($i == 1)
{
    // do something...
}

// хорошо
if ($i == 1) {
    // do something...
}
```

- Тело конструкции должно иметь отступ.

- Закрывающая фигурная скобка должна быть на новой строке.

```php
<?php
// плохо
if ($i == 1){
    $i = 0;}

// хорошо
if ($i == 1) {
    $i = 0;
}
```

### `if`, `elseif`, `else`

Вместо **`else if`** используйте **`elseif`**.

```php
<?php
if ($expr1) {
    // if body
} elseif ($expr2) {
    // elseif body
} else {
    // else body
}
```

### `swicth`, `case`

Ключевое слово **`case`** должно иметь отступ по отношению к **`swicth`**. Ключевое слово **`break`** и тело так же должны иметь отступ по отношению к **`case`**.

Если не используется **`break`**, то вместо него должен быть комментарий **`// no break`**.

Разделяйте каждый блок одной пустой строкой.

```php
<?php
switch ($expr) {
    case 0:
        echo 'First case, with a break';
        break;

    case 1:
        echo 'Second case, which falls through';
        // no break

    case 2:
    case 3:
    case 4:
        echo 'Third case, return instead of break';
        return;

    default:
        echo 'Default case';
        break;
}
```

### `while`, `do while`

```php
<?php
while ($expr) {
    // do something...
}
```

```php
<?php
do {
    // do something...
} while ($expr);
```

### `for`

```php
<?php
for ($i = 0; $i < 10; $i++) {
    // for body
}
```

### `foreach`

```php
<?php
foreach ($array as $key => $value) {
    // foreach body
}
```

### `try`, `catch`

```php
<?php
try {
    // try body
} catch (FirstExceptionType $e) {
    // catch body
} catch (OtherExceptionType $e) {
    // catch body
} finally {
    // finally body
}
```

### Управляющие конструкции вместе с кодом HTML

Используйте альтернативный синтаксис для **`if`**, **`while`**, **`for`**, **`foreach`** и **`switch`**, когда используете код PHP вперемешку с HTML. Вместо открывающей фигурной скобки используется двоеточие (без пробела перед ним), а вместо закрывающей **`endif;`**, **`endwhile;`**, **`endfor;`**, **`endforeach;`** или **`endswitch;`** соответственно.

```
<?php if (!empty($item)): ?>
    <p><?= $item; ?></p>
<?php endif; ?>

<?php foreach ($items as $item): ?>
    <p><?= $item; ?></p>
<?php endforeach; ?>
```

Читайте про особенности использования альтернативного синтаксиса в [документации](http://php.net/manual/ru/control-structures.alternative-syntax.php).

## Комментарии

- Комментарий должен идти перед кодом, к которому относится.

- Содержание комментария должно описывать суть и иметь смысл.

- Если вы пишите комментарий из-за непонятности части кода, возможно стоит переписать код или использовать более понятные имена переменных, функций, методов и т.д. Хороший код не нуждается в комментировании. Это не касается PHPDoc.

## Пространства имен

- Файл должен содержать только одно объявление пространства имен.

- Объявление пространства имен должно быть в самом начале файла, на следующей строке после открывающего тега **`<?php`**.

- Название должно быть в UpperCamelCase (каждое слово с заглавной буквы).

- После объявления пространства имен должна быть пустая строка.

- Каждый оператор **`use`** должен быть на отдельной строке.

- После блока с **`use`** должна быть пустая строка.

```php
<?php
namespace Epic\MyBlog;

use MyNamespace\Block\ClassName as ClassName;
use MyNamespace\AnotherBlock\AnotherClassName;

$obj = new AnotherClassName();
```

## Классы (а так же интерфейсы и трейты), свойства, методы

- Ключевые слова **`extends`** и **`implements`** должны быть на одной строке с именем класса.

- Открывающая и закрывающая фигурные скобки должны быть на новой строке.

- Если класс реализует несколько интерфейсов и их необходимо перенести на новую строку, то каждый из интерфейсов должен быть указан на новой строке с отступом.

```php
<?php
namespace Vendor\Package;

use FooClass;
use BarClass as Bar;
use OtherVendor\OtherPackage\BazClass;

class ClassName extends ParentClass implements
    \ArrayAccess,
    \Countable,
    \Serializable
{
    // constants, properties, methods
}
```

- Область видимости **`public`**, **`protected`** или **`private`** должна явно быть указана для всех свойств и методов.

- Каждое свойство должно быть объявлено на новой строке, без пустых строк между ними. Сначала объявляются публичные свойства, затем защищенные, потом приватные.

- Объявление методов должно быть разделено пустой строкой.

- Не используйте знак подчеркивания в начале имени свойства или метода для обозначения **`protected`** или **`private`**.

- Ключевое слово **`static`** должно быть после указания видимости.

- Ключевые слова **`abstract`** и **`final`** должны быть перед указанием видимости.

```php
<?php
namespace Vendor\Package;

abstract class ClassName
{
    protected static $foo;

    abstract protected function zim();

    final public static function bar()
    {
        // method body
    }
}
```

## Дополнительные материалы

- PHP Standard Recommendation (PSR) - [http://www.php-fig.org/](http://www.php-fig.org/)
- PHP: Правильный Путь - [http://getjump.me/ru-php-the-right-way/](http://getjump.me/ru-php-the-right-way/)